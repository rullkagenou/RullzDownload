<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rullz.Downloader</title>
  <style>
    :root{
      --bg:#0f172a;
      --card:#1e293b;
      --accent:#00bfff;
      --muted:#cbd5e1;
      --btn:#00bfff;
      --green:#25D366;
    }
    body { margin:0; font-family:Arial,sans-serif; background:var(--bg); color:white }
    .container{padding:28px;max-width:720px;margin:auto}
    header{text-align:center;margin-bottom:28px}
    header h1{color:var(--accent);margin:0;font-size:24px}
    header .muted{color:var(--muted);font-size:14px}
    .search-box{background:rgba(255,255,255,.02);border-radius:12px;padding:20px;box-shadow:0 6px 20px rgba(0,191,255,.03)}
    
    .input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
      background: rgba(255,255,255,.05);
      border-radius: 10px;
      overflow: hidden;
    }
    input[type=text] {
      flex: 1;
      border: none;
      outline: none;
      background: transparent;
      color: var(--muted);
      padding: 12px 46px 12px 14px; 
      font-size: 16px;
    }
    .paste-btn {
      position: absolute;
      right: 8px;  
      top: 50%;
      transform: translateY(-50%);
      background: var(--accent);
      color: white;
      border: none;
      width: 36px;
      height: 36px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
    }
    .btn-primary{background:var(--btn);color:white;padding:12px 16px;border-radius:10px;font-weight:700;text-decoration:none;cursor:pointer;border:none;text-align:center}
    .btn-green{background:var(--green)}
    .btn-group{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
    .btn-group .btn-primary{flex:1}
    .card{background:var(--card);padding:18px;border-radius:12px;margin-top:18px;box-shadow:0 8px 30px rgba(0,0,0,.45)}
    video,img,audio{width:100%;border-radius:10px;display:block;background:#000}
    .download-btn{display:block;width:calc(100% - 4px);margin:8px auto 0;text-align:center;background:linear-gradient(90deg,#00bfff,#0066cc);color:white;padding:14px;border-radius:10px;font-size:16px;font-weight:700;cursor:pointer;border:none}
    .download-btn--alt{background:linear-gradient(90deg,#25D366,#1aa34a)}
    .muted{color:var(--muted);font-size:13px}
  </style>
</head>
<body>
  <main class="container">
    <header>
      <h1>Downloader AIO</h1>
      <div class="muted">Masukkan link ig, tiktok, dll</div>
      <div style="margin:16px auto;max-width:600px;background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 4px 12px rgba(0,0,0,0.1);">
        <img src="https://raw.githubusercontent.com/rullkagenou/RullzUploadArthur/main/uploads/2025-09-07/upload_1757241399853.jpg" 
             alt="Banner"
             style="width:100%;height:auto;display:block;">
      </div>
    </header>

    <section class="search-box card">
      <div class="input-wrapper">
        <input id="urlInput" type="text" placeholder="Tempel link di sini...">
        <button class="paste-btn" onclick="pasteClipboard()">ðŸ“‹</button>
      </div>
      <div class="btn-group">
        <button class="btn-primary" onclick="getMedia()">Unduh</button>
        <button class="btn-primary" onclick="openAdmin()">Chat Admin</button>
      </div>
      <div id="result" style="margin-top:16px"></div>
    </section>

    <section class="card">
      <h3 style="color:var(--accent)">Cara Pakai</h3>
      <ol class="muted" style="padding-left:16px;">
        <li>Tempel link postingan</li>
        <li>Klik "Unduh"</li>
        <li>Preview tampil â†’ tekan tombol download</li>
      </ol>
    </section>

    <section class="card">
      <h3 style="color:var(--accent)">Tentang</h3>
      <p class="muted">Rullz Downloader â€” platform simpel buat unduh konten sosial media dengan cepat dan mudah.</p>
    </section>
  </main>

<script>
function openAdmin(){
  window.open("https://wa.me/6283892730732?text=Bang%20Rullz%20web%20nya%20eror", "_blank");
}

async function pasteClipboard(){
  try{
    const text = await navigator.clipboard.readText();
    if(text){
      document.getElementById('urlInput').value = text.trim();
    }else{
      alert('Clipboard kosong atau tidak ada link disalin.');
    }
  }catch(e){
    alert('Gagal akses clipboard, coba manual tempel (CTRL+V).');
  }
}

function downloadFile(url, filename){
  const link = document.createElement("a");
  link.href = `/api/download?url=${encodeURIComponent(url)}&filename=${encodeURIComponent(filename)}`;
  link.target = "_blank"; 
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

async function getMedia(){
  const url=document.getElementById('urlInput').value.trim();
  const result=document.getElementById('result');
  if(!url){alert('Masukkan link dulu!');return;}
  result.innerHTML='<div class="muted">Mengambil data...</div>';
  try{
    const r=await fetch(`https://api.finix-id.my.id/download/aio?url=${encodeURIComponent(url)}`);
    const data=await r.json();
    if(!data||!data.status||!data.result){
      result.innerHTML='<div class="muted" style="color:#ffcc00">Gagal ambil data.</div>';
      return;
    }

    const medias=data.result.medias||[];
    let html='';

    const videos=medias.filter(m=>m.type==='video');
    if(videos.length){
      const best=videos.find(v=>/hd_no_watermark/i.test(v.quality))||videos[0];
      html+=`
      <div>
        <h4 style="color:var(--accent)">Video</h4>
        <video controls muted playsinline>
          <source src="${best.url}" type="video/mp4">
        </video>
        <button class="download-btn" onclick="downloadFile('${best.url}','video.mp4')">
          Download Video
        </button>
      </div>`;
    }

    const images=medias.filter(m=>m.type==='image');
    if(images.length){
      html+=`<div><h4 style="color:var(--accent)">Gambar</h4>`;
      images.forEach((img,i)=>{
        html+=`
        <img src="${img.url}" style="margin-top:8px">
        <button class="download-btn" onclick="downloadFile('${img.url}','image_${i+1}.jpg')">
          Download Gambar
        </button>`;
      });
      html+=`</div>`;
    }

    const audios=medias.filter(m=>m.type==='audio'||['mp3','m4a'].includes(m.extension));
    if(audios.length){
      html+=`<div><h4 style="color:var(--accent)">Audio</h4>`;
      audios.forEach((a,i)=>{
        const ext=a.extension||'mp3';
        html+=`
        <audio controls>
          <source src="${a.url}" type="audio/${ext}">
        </audio>
        <button class="download-btn" onclick="downloadFile('${a.url}','audio_${i+1}.${ext}')">
          Download Audio
        </button>`;
      });
      html+=`</div>`;
    }

    if(!html) html='<div class="muted">Media tidak ditemukan.</div>';
    result.innerHTML=html;
  }catch(e){
    console.error(e);
    result.innerHTML='<div class="muted" style="color:#ff6b6b">Terjadi error.</div>';
  }
}
</script>
</body>
</html>
